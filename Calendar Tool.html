<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;br/&gt;</p>
<p class="p1">&lt;title&gt;Create Your Own Event on Google Calendar&lt;/title&gt;</p>
<p class="p1">&lt;link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css"&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;style&gt;</p>
<p class="p2"><br></p>
<p class="p1">legend { font-weight:bold; text-align: center; }</p>
<p class="p1">form table { width:100%; margin:auto; }</p>
<p class="p1">form th { width:10%;padding:10px;vertical-align:top; text-align:right; }</p>
<p class="p1">form td { width:100%;padding:10px; text-align:left;}</p>
<p class="p1">form td.date input[type=text] { width:12em; }</p>
<p class="p1">form input.eventinfo, input.eventurl { width:100%; }</p>
<p class="p1">form textarea { width:100%; height:8em; }</p>
<p class="p1">#result { display:none; text-align: center; font-weight:bold; }</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;fieldset&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;form&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;table&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th&gt;Title&lt;/th&gt;&lt;td&gt;&lt;input placeholder="e.g. Take Ryan to Caulfield Park" class="eventinfo" type="text" name="event_title" id="event_title"&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/tr&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th&gt;Date&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;td class="date"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="text" name="dtstart_date" id="dtstart_date"&gt; &lt;select name="dtstart_time" id="dtstart_time"&gt;&lt;/select&gt; To &lt;input type="text" name="dtend_date" id="dtend_date"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;select name="dtend_time" id="dtend_time"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label&gt;&amp;nbsp&amp;nbsp&amp;nbsp&lt;input type="checkbox" name="allday" id="allday"&gt; All Day&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/tr&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th&gt;Location&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;td&gt;&lt;input placeholder="e.g. 280 Balaclava Rd, Caulfield North VIC 3162" class="eventinfo" type="text" name="event_location" id="event_location"&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th&gt;Details&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;td&gt;&lt;textarea class="eventinfo" name="event_details" id="event_details" placeholder="e.g. Remember to take the water bottle."&gt;&lt;/textarea&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;th&gt;&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="reset" value="Clear"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="submit" value="Create Event"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/form&gt;</p>
<p class="p1">&lt;/fieldset&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;br/&gt;</p>
<p class="p1">&lt;fieldset id="result" style="font-size:18px;"&gt;Your event has been successfully created!&lt;br/&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;a target="_blank" href="#" id="url_link" rel="noopener noreferrer" style="color:#2f517c; font-size:18px; text-decoration:underline;" &gt;Click Here to add this event into your Google Calendar&lt;/a&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input class="eventurl" type="text" name="url" id="url"&gt;</p>
<p class="p1">&lt;/fieldset&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"&gt;&lt;/script&gt;</p>
<p class="p1">&lt;script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"&gt;&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">$(function(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#dtstart_date').datepicker({dateFormat:'yy/mm/dd'});</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#dtend_date').datepicker({dateFormat:'yy/mm/dd'});</p>
<p class="p1"><span class="Apple-converted-space">    </span>var time_list_h = [ '00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23' ];</p>
<p class="p1"><span class="Apple-converted-space">    </span>var time_list_m = [ '00', '15', '30', '45' ];</p>
<p class="p1"><span class="Apple-converted-space">    </span>for ( var i in time_list_h ){</p>
<p class="p1"><span class="Apple-converted-space">        </span>for ( var j in time_list_m ){</p>
<p class="p1"><span class="Apple-converted-space">            </span>$('#dtstart_time').append('&lt;option&gt;'+ time_list_h[i] +':'+ time_list_m[j] +'&lt;/option&gt;');</p>
<p class="p1"><span class="Apple-converted-space">            </span>$('#dtend_time').append('&lt;option&gt;'+ time_list_h[i] +':'+ time_list_m[j] +'&lt;/option&gt;');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">    </span>var yyyymmdd = now.getFullYear() +'/'+ ( '0'+( now.getMonth()+1 ) ).slice(-2) +'/'+ ( '0'+now.getDate() ).slice(-2);</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#dtstart_date').val( yyyymmdd );</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#dtend_date').val( yyyymmdd );</p>
<p class="p1">});</p>
<p class="p1">$('#allday').click(function(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>if ( $('#dtstart_time').css('display').indexOf('block') !== -1 ) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>$('#dtstart_time').hide();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>$('#dtstart_time').show();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>if ( $('#dtend_time').css('display').indexOf('block') !== -1<span class="Apple-converted-space">  </span>) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>$('#dtend_time').hide();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>$('#dtend_time').show();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">$('form').submit(function(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>var event_title = $('#event_title').val();</p>
<p class="p1"><span class="Apple-converted-space">    </span>var event_details = $('#event_details').val();</p>
<p class="p1"><span class="Apple-converted-space">    </span>var event_location = $('#event_location').val();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtstart_date_obj = $('#dtstart_date').val().split('/');</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtend_date_obj = $('#dtend_date').val().split('/');</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtstart = new Date( dtstart_date_obj[0], dtstart_date_obj[1] - 1, dtstart_date_obj[2] );</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtend = new Date( dtend_date_obj[0], dtend_date_obj[1] - 1, dtend_date_obj[2] );</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var is_allday = ( $('#dtstart_time').css('display').indexOf('block') !== -1 &amp;&amp; $('#dtend_time').css('display').indexOf('block') !== -1 ) ? false : true;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if( !is_allday ){</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtstart_time_obj = $('#dtstart_time').val().split(':');</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtend_time_obj = $('#dtend_time').val().split(':');</p>
<p class="p1"><span class="Apple-converted-space">        </span>dtstart.setHours( dtstart_time_obj[0], dtstart_time_obj[1] );</p>
<p class="p1"><span class="Apple-converted-space">        </span>dtend.setHours( dtend_time_obj[0], dtend_time_obj[1]) ;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>dtstart.setHours( dtstart.getHours() + ( (new Date()).getTimezoneOffset() / 60 ) );</p>
<p class="p1"><span class="Apple-converted-space">        </span>dtend.setHours( dtend.getHours() + ( (new Date()).getTimezoneOffset() / 60 ) );</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>dtend.setDate( dtend.getDate() + 1 );</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtstart_year = dtstart.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtstart_month = dtstart.getMonth() + 1;</p>
<p class="p1"><span class="Apple-converted-space">    </span>dtstart_month = ( dtstart_month &lt; 10 ) ? '0' + dtstart_month.toString() : dtstart_month;</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtstart_day = ( dtstart.getDate() &lt; 10 ) ? '0' + dtstart.getDate() : dtstart.getDate();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtend_year = dtend.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtend_month = dtend.getMonth() + 1;</p>
<p class="p1"><span class="Apple-converted-space">    </span>dtend_month = ( dtend_month &lt; 10 ) ? '0' + dtend_month.toString() : dtend_month;</p>
<p class="p1"><span class="Apple-converted-space">    </span>var dtend_day = ( dtend.getDate() &lt; 10 ) ? '0' + dtend.getDate() : dtend.getDate();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if( !is_allday ){</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtstart_hour = ( dtstart.getHours() &lt; 10 ) ? '0' + dtstart.getHours().toString() : dtstart.getHours();</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtstart_min = ( dtstart.getMinutes() &lt; 10 ) ? '0' + dtstart.getMinutes().toString() : dtstart.getMinutes();</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtend_hour = ( dtend.getHours() &lt; 10 ) ? '0' + dtend.getHours().toString() : dtend.getHours();</p>
<p class="p1"><span class="Apple-converted-space">        </span>var dtend_min = ( dtend.getMinutes() &lt; 10 ) ? '0' + dtend.getMinutes().toString() : dtend.getMinutes();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>var url = 'https://www.google.com/calendar/render?action=TEMPLATE';</p>
<p class="p1"><span class="Apple-converted-space">    </span>url += '&amp;text=' + encodeURI(event_title);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>if( is_allday ){</p>
<p class="p1"><span class="Apple-converted-space">        </span>url += '&amp;dates=' + dtstart_year.toString() + dtstart_month.toString() + dtstart_day.toString() +'/'+ dtend_year.toString() + dtend_month.toString() + dtend_day.toString();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>url += '&amp;dates=' + dtstart_year.toString() + dtstart_month.toString() + dtstart_day.toString() +'T'+ dtstart_hour.toString() +<span class="Apple-converted-space">  </span>dtstart_min.toString() + '00Z/';</p>
<p class="p1"><span class="Apple-converted-space">        </span>url += dtend_year.toString() + dtend_month.toString() + dtend_day.toString() +'T'+ dtend_hour.toString() +<span class="Apple-converted-space">  </span>dtend_min.toString() + '00Z';</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>url += '&amp;location=' + encodeURI(event_location);</p>
<p class="p1"><span class="Apple-converted-space">    </span>url += '&amp;sprop=name%3aName&amp;sprop=website%3aEventWebite';</p>
<p class="p1"><span class="Apple-converted-space">    </span>url += '&amp;details=' + encodeURI(event_details);</p>
<p class="p1"><span class="Apple-converted-space">    </span>url += '&amp;sf=true&amp;output=xml';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#url').val(url);</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#url_link').attr('href',url);</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#result').fadeIn();</p>
<p class="p1"><span class="Apple-converted-space">    </span>return false;</p>
<p class="p1">});</p>
<p class="p1">$('#url').focus(function(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>this.select();</p>
<p class="p1">});&lt;/script&gt;</p>
<p class="p1">&lt;script type="text/javascript"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>$(document).ready(function(){</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var url_string = window.location.href;</p>
<p class="p1">var url = new URL(url_string);</p>
<p class="p1">var place_name = url.searchParams.get("place_name");</p>
<p class="p1">if(place_name != null){</p>
<p class="p1">place_name = place_name.substring(1, place_name.length-1) ;}</p>
<p class="p1">var place_address = url.searchParams.get("place_address");</p>
<p class="p1">if(place_address != null){</p>
<p class="p1">place_address = place_address.substring(1, place_address.length-1) ;</p>
<p class="p1">}</p>
<p class="p1">$("#event_title").val(place_name);</p>
<p class="p1">$("#event_location").val(place_address);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
</body>
</html>
